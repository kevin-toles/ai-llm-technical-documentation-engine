You are conducting a comprehensive scholarly cross-reference analysis for Learning Python Ed.6.

CHAPTER {chapter_num}: {chapter_title}

FULL CHAPTER TEXT ({chapter_text_length} characters):
{chapter_text_preview}
{chapter_text_truncation}

COMPANION BOOKS AVAILABLE ({books_count} books with chapter metadata):
{books_text}

NOTE: Book content is NOT loaded yet - only metadata is shown above.
After you make your requests, the system will load ONLY the specific chapters you request.
This saves memory and tokens, so feel free to request what you need!

YOUR TASK:

1. READ & ANALYZE THE CHAPTER:
   - Extract ALL key concepts, techniques, and topics covered
   - Identify main themes and learning objectives
   - Note examples, code patterns, and pedagogical approaches

2. CROSS-REFERENCE DISCOVERY:
   - Review the 15 companion books above
   - For each book, consider both:
     * Overall concepts covered (shown in metadata)
     * Specific chapters that might relate (when chapter metadata available)
   - Use the book taxonomy:
     * Architecture Spine books: Patterns, DDD, microservices theory
     * Implementation Layer books: FastAPI, Flask, deployment, APIs
     * Engineering Practices books: Python idioms, recipes, language reference

3. REQUEST SPECIFIC CHAPTERS/SECTIONS:
   - For books WITH chapter metadata: Request specific chapters by number/title
     Example: "Chapter 5: Decorators" or "Chapter 8: Async Programming"
   - For books WITHOUT chapter metadata: Request page ranges that likely contain relevant content
   - Explain WHY each chapter/section would help build cross-references
   - Prioritize books that offer different perspectives (architecture vs implementation vs idioms)

RESPOND IN JSON FORMAT:
{{
  "concepts_extracted": ["list", "of", "all", "concepts", "found"],
  "themes_identified": ["main", "themes"],
  "content_requests": [
    {{
      "book_name": "exact book title",
      "chapters_or_sections": ["Chapter 5: Decorators", "Chapter 8, Section 2"],
      "pages": [145, 146, 147],
      "rationale": "why this content will enhance cross-references",
      "priority": 1-5
    }}
  ],
  "analysis_strategy": "Your plan for synthesizing an integrated annotation"
}}

GUIDELINES:
- Extract concepts comprehensively (don't rely on pre-defined keywords)
- Request 6-12 books that offer substantive cross-references
- Use chapter metadata when available for precise targeting
- Build many-to-many mapping across multiple books
- Consider cascading: Engineering concepts → Architecture patterns → Implementation examples

IMPORTANT CONSTRAINT:
To ensure focused, high-quality cross-references, please limit your content_requests to the TOP 10 most relevant books. Prioritize quality over quantity - select only those books that provide the most substantive connections to the current chapter's concepts.

Provide your comprehensive analysis now.
